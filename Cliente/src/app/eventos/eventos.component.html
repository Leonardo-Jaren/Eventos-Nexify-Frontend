<app-navigation></app-navigation>
<div class="container mx-auto py-10 pt-24">
  <h2 class="text-3xl font-bold text-gray-800 text-center mb-8">Lista de Eventos</h2>

  <div *ngIf="errorMessage" class="text-red-500 text-center">
    {{ errorMessage }}
  </div>

  <!-- Lista de eventos -->
  <div *ngIf="eventos.length > 0; else noEventos" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <div *ngFor="let evento of eventos" (click)="abrirModal(evento)" class="bg-white rounded-lg shadow-lg overflow-hidden cursor-pointer">
      <!-- Imagen del evento -->
      <div class="h-48 bg-gray-200">
        <img 
          [src]="evento.imagen" 
          alt="Imagen del Evento" 
          class="w-full h-full object-cover"
        />
      </div>
      <!-- Información del evento -->
      <div class="p-4">
        <h3 class="text-lg font-bold text-gray-800 mb-2 truncate">{{ evento.nombre_evento }}</h3>
        <p class="text-gray-600 text-sm mb-2 truncate">
          <strong>Descripción:</strong> {{ evento.descripcion }}
        </p>
        <p class="text-gray-600 text-sm mb-2">
          <strong>Fecha:</strong> {{ evento.fechaEvento | date: 'longDate' }}
        </p>
        <p class="text-gray-600 text-sm mb-2">
          <strong>Tipo:</strong> {{ evento.tipo_evento }}
        </p>
        <p *ngIf="evento.tipo_evento === 'Presencial'" class="text-gray-600 text-sm">
          <strong>Ubicación:</strong> {{ evento.ubicacion }}
        </p>
      </div>
    </div>
  </div>

  <!-- Modal con los detalles completos del evento -->
  <div *ngIf="modalAbierto" 
  class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"
  (click)="cerrarModal($event)">
    <div class="bg-white p-8 rounded-lg max-w-4xl w-full flex" (click)="$event.stopPropagation()">
      <!-- Imagen a la izquierda -->
      <div class="w-1/3 h-48 bg-gray-200 rounded-lg overflow-hidden mr-6">
      <img 
        [src]="eventoSeleccionado.imagen" 
        alt="Imagen del Evento" 
        class="w-full h-full object-cover"
      />
      </div>

      <!-- Contenido del modal a la derecha -->
        <div class="w-2/3">
          <h3 class="text-2xl font-bold text-gray-800 mb-4">{{ eventoSeleccionado.nombre_evento }}</h3>
          <p><strong>Descripción:</strong> {{ eventoSeleccionado.descripcion }}</p>
          <p><strong>Fecha:</strong> {{ eventoSeleccionado.fechaEvento | date: 'short' }}</p>
          <p><strong>Tipo:</strong> {{ eventoSeleccionado.tipo_evento }}</p>
          <p *ngIf="eventoSeleccionado.tipo_evento === 'Presencial'"><strong>Ubicación:</strong> {{ eventoSeleccionado.ubicacion }}</p>
          <p><strong>Estado:</strong> {{ eventoSeleccionado.estadoEvento }}</p>
          <p><strong>Ponente:</strong> {{ eventoSeleccionado.ponente.username }}</p>
          <!-- Lista de participantes -->
          <div *ngIf="eventoSeleccionado.participantes && eventoSeleccionado.participantes.length > 0">
            <strong>Participantes:</strong>
            <ul>
              <li *ngFor="let participante of eventoSeleccionado.participantes">{{ participante.username }}</li>
            </ul>
          </div>
          <!-- Botón de Inscripción visible solo si el rol es 'participante' -->
        <button *ngIf="getUserRole() === 'Participante'" (click)="inscribirse(eventoSeleccionado)" 
              class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">
          Inscribirse
        </button>

        <!-- eventos.component.html -->
        <p-dialog [(visible)]="displayModal" [modal]="true" [style]="{width: '700px'}">
          <app-detalles></app-detalles> <!-- Asegúrate de que este sea el selector correcto -->
        </p-dialog>

        <button *ngIf="getUserRole() === 'Coordinador'" 
                (click)="editarEvento()" 
                class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">
          Editar Evento
        </button>

        </div>
    </div>
  </div>

  <!-- Mensaje si no hay eventos -->
  <ng-template #noEventos>
    <p class="text-gray-500 text-center">No hay eventos registrados.</p>
  </ng-template>
</div>
